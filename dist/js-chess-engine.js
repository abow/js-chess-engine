!function(t,s){"object"==typeof exports&&"object"==typeof module?module.exports=s():"function"==typeof define&&define.amd?define("js-chess-engine",[],s):"object"==typeof exports?exports["js-chess-engine"]=s():t["js-chess-engine"]=s()}(this,(function(){return function(t){var s={};function i(e){if(s[e])return s[e].exports;var o=s[e]={i:e,l:!1,exports:{}};return t[e].call(o.exports,o,o.exports,i),o.l=!0,o.exports}return i.m=t,i.c=s,i.d=function(t,s,e){i.o(t,s)||Object.defineProperty(t,s,{enumerable:!0,get:e})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,s){if(1&s&&(t=i(t)),8&s)return t;if(4&s&&"object"==typeof t&&t&&t.__esModule)return t;var e=Object.create(null);if(i.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:t}),2&s&&"string"!=typeof t)for(var o in t)i.d(e,o,function(s){return t[s]}.bind(null,o));return e},i.n=function(t){var s=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(s,"a",s),s},i.o=function(t,s){return Object.prototype.hasOwnProperty.call(t,s)},i.p="",i(i.s=0)}([function(t,s,i){"use strict";i.r(s),i.d(s,"Game",(function(){return P})),i.d(s,"moves",(function(){return v})),i.d(s,"status",(function(){return k})),i.d(s,"getFen",(function(){return A})),i.d(s,"move",(function(){return C})),i.d(s,"aiMove",(function(){return E}));const e=["A","B","C","D","E","F","G","H"],o=["1","2","3","4","5","6","7","8"],r="black",l="white",h=[0,1,2,3],n={turn:l,pieces:{E1:"K",D1:"Q",A1:"R",H1:"R",C1:"B",F1:"B",B1:"N",G1:"N",A2:"P",B2:"P",C2:"P",D2:"P",E2:"P",F2:"P",G2:"P",H2:"P",E8:"k",D8:"q",A8:"r",H8:"r",C8:"b",F8:"b",B8:"n",G8:"n",A7:"p",B7:"p",C7:"p",D7:"p",E7:"p",F7:"p",G7:"p",H7:"p"}};class c{constructor(t,s){this.chessMan=null,this.color=t,this.location=s,this.neighbours={left:null,right:null,up:null,down:null}}up(t=l){return t===l?this.neighbours.up:this.neighbours.down}down(t=l){return t===l?this.neighbours.down:this.neighbours.up}left(t=l){return t===l?this.neighbours.left:this.neighbours.right}right(t=l){return t===l?this.neighbours.right:this.neighbours.left}upLeft(t){return this.up(t)?this.up(t).left(t):null}upRight(t){return this.up(t)?this.up(t).right(t):null}downLeft(t){return this.down(t)?this.down(t).left(t):null}downRight(t){return this.down(t)?this.down(t).right(t):null}setField(t){this.chessMan&&this.removeChessMan(),t&&(t.field=this),this.chessMan=t}removeChessMan(){Object.assign(this.chessMan.field,null),Object.assign(this.chessMan,null)}isEmpty(){return null==this.chessMan}isWhite(){return this.color===l}isBlack(){return this.color===r}getUnicode(){if(!this.isEmpty())return this.chessMan.getUnicode();if(this.isBlack())return"░";if(this.isWhite())return"█";throw new Error("No unicode defined")}}class a{constructor(t){this.color=t,this.field=null,this.moved=!1,this.board=null}getValue(){return 0}isInGame(){return!!this.field}isWhite(){return this.color===l}isBlack(){return this.color===r}getUnicode(){throw new Error("No unicode defined")}getAlias(){throw new Error("Alias not defined")}getMoves(){throw new Error("Not implemented")}isMoveInMoves(t){return this.getMoves().includes(t)}isKing(){return!1}isRook(){return!1}isPawn(){return!1}getMovesUpAll(){const t=[];let s=this.field;for(;s.up(this.color)&&s.up(this.color).isEmpty();)s=s.up(this.color),t.push(s.location);return s.up(this.color)&&s.up(this.color).chessMan.color!==this.color&&t.push(s.up(this.color).location),t}getMovesDownAll(){const t=[];let s=this.field;for(;s.down(this.color)&&s.down(this.color).isEmpty();)s=s.down(this.color),t.push(s.location);return s.down(this.color)&&s.down(this.color).chessMan.color!==this.color&&t.push(s.down(this.color).location),t}getMovesRightAll(){const t=[];let s=this.field;for(;s.right(this.color)&&s.right(this.color).isEmpty();)s=s.right(this.color),t.push(s.location);return s.right(this.color)&&s.right(this.color).chessMan.color!==this.color&&t.push(s.right(this.color).location),t}getMovesLeftAll(){const t=[];let s=this.field;for(;s.left(this.color)&&s.left(this.color).isEmpty();)s=s.left(this.color),t.push(s.location);return s.left(this.color)&&s.left(this.color).chessMan.color!==this.color&&t.push(s.left(this.color).location),t}getMovesUpLeftAll(){const t=[];let s=this.field;for(;s.upLeft(this.color)&&s.upLeft(this.color).isEmpty();)s=s.upLeft(this.color),t.push(s.location);return s.upLeft(this.color)&&s.upLeft(this.color).chessMan.color!==this.color&&t.push(s.upLeft(this.color).location),t}getMovesUpRightAll(){const t=[];let s=this.field;for(;s.upRight(this.color)&&s.upRight(this.color).isEmpty();)s=s.upRight(this.color),t.push(s.location);return s.upRight(this.color)&&s.upRight(this.color).chessMan.color!==this.color&&t.push(s.upRight(this.color).location),t}getMovesDownRightAll(){const t=[];let s=this.field;for(;s.downRight(this.color)&&s.downRight(this.color).isEmpty();)s=s.downRight(this.color),t.push(s.location);return s.downRight(this.color)&&s.downRight(this.color).chessMan.color!==this.color&&t.push(s.downRight(this.color).location),t}getMovesDownLeftAll(){const t=[];let s=this.field;for(;s.downLeft(this.color)&&s.downLeft(this.color).isEmpty();)s=s.downLeft(this.color),t.push(s.location);return s.downLeft(this.color)&&s.downLeft(this.color).chessMan.color!==this.color&&t.push(s.downLeft(this.color).location),t}}class u extends a{getValue(){return 10}isKing(){return!0}getUnicode(){return this.isWhite()?"♚":this.isBlack()?"♔":super.getUnicode()}getAlias(){return this.isWhite()?"K":this.isBlack()?"k":super.getAlias()}getMoves(){const t=[];return this.field.up(this.color)&&(this.field.up(this.color).isEmpty()||this.field.up(this.color).chessMan.color!==this.color)&&t.push(this.field.up(this.color).location),this.field.down(this.color)&&(this.field.down(this.color).isEmpty()||this.field.down(this.color).chessMan.color!==this.color)&&t.push(this.field.down(this.color).location),this.field.left(this.color)&&(this.field.left(this.color).isEmpty()||this.field.left(this.color).chessMan.color!==this.color)&&t.push(this.field.left(this.color).location),this.field.right(this.color)&&(this.field.right(this.color).isEmpty()||this.field.right(this.color).chessMan.color!==this.color)&&t.push(this.field.right(this.color).location),this.field.upRight(this.color)&&(this.field.upRight(this.color).isEmpty()||this.field.upRight(this.color).chessMan.color!==this.color)&&t.push(this.field.upRight(this.color).location),this.field.upLeft(this.color)&&(this.field.upLeft(this.color).isEmpty()||this.field.upLeft(this.color).chessMan.color!==this.color)&&t.push(this.field.upLeft(this.color).location),this.field.downLeft(this.color)&&(this.field.downLeft(this.color).isEmpty()||this.field.downLeft(this.color).chessMan.color!==this.color)&&t.push(this.field.downLeft(this.color).location),this.field.downRight(this.color)&&(this.field.downRight(this.color).isEmpty()||this.field.downRight(this.color).chessMan.color!==this.color)&&t.push(this.field.downRight(this.color).location),t}}class d extends a{getValue(){return 9}getUnicode(){return this.isWhite()?"♛":this.isBlack()?"♕":super.getUnicode()}getAlias(){return this.isWhite()?"Q":this.isBlack()?"q":super.getAlias()}getMoves(){return[...this.getMovesUpAll(),...this.getMovesDownAll(),...this.getMovesLeftAll(),...this.getMovesRightAll(),...this.getMovesUpLeftAll(),...this.getMovesUpRightAll(),...this.getMovesDownRightAll(),...this.getMovesDownLeftAll()]}}class g extends a{getValue(){return 1}isPawn(){return!0}getUnicode(){return this.isWhite()?"♟":this.isBlack()?"♙":super.getUnicode()}getAlias(){return this.isWhite()?"P":this.isBlack()?"p":super.getAlias()}isInStartLine(){return!(!this.isWhite()||"2"!==this.field.location[1])||!(!this.isBlack()||"7"!==this.field.location[1])}getMoves(){const t=[];return this.field.up(this.color)&&this.field.up(this.color).isEmpty()&&(t.push(this.field.up(this.color).location),this.isInStartLine()&&this.field.up(this.color).up(this.color)&&this.field.up(this.color).up(this.color).isEmpty()&&t.push(this.field.up(this.color).up(this.color).location)),this.field.upLeft(this.color)&&(!this.field.upLeft(this.color).isEmpty()&&this.field.upLeft(this.color).chessMan.color!==this.color||this.field.upLeft(this.color).location===this.board.enPassant)&&t.push(this.field.upLeft(this.color).location),this.field.upRight(this.color)&&(!this.field.upRight(this.color).isEmpty()&&this.field.upRight(this.color).chessMan.color!==this.color||this.field.upRight(this.color).location===this.board.enPassant)&&t.push(this.field.upRight(this.color).location),t}}class p extends a{getValue(){return 3}getUnicode(){return this.isWhite()?"♞":this.isBlack()?"♘":super.getUnicode()}getAlias(){return this.isWhite()?"N":this.isBlack()?"n":super.getAlias()}getMoves(){const t=[];if(this.field.up(this.color)&&this.field.up(this.color).up(this.color)){const s=this.field.up(this.color).up(this.color);s.left(this.color)&&(s.left(this.color).isEmpty()||s.left(this.color).chessMan.color!==this.color)&&t.push(s.left(this.color).location),s.right(this.color)&&(s.right(this.color).isEmpty()||s.right(this.color).chessMan.color!==this.color)&&t.push(s.right(this.color).location)}if(this.field.down(this.color)&&this.field.down(this.color).down(this.color)){const s=this.field.down(this.color).down(this.color);s.left(this.color)&&(s.left(this.color).isEmpty()||s.left(this.color).chessMan.color!==this.color)&&t.push(s.left(this.color).location),s.right(this.color)&&(s.right(this.color).isEmpty()||s.right(this.color).chessMan.color!==this.color)&&t.push(s.right(this.color).location)}if(this.field.left(this.color)&&this.field.left(this.color).left(this.color)){const s=this.field.left(this.color).left(this.color);s.down(this.color)&&(s.down(this.color).isEmpty()||s.down(this.color).chessMan.color!==this.color)&&t.push(s.down(this.color).location),s.up(this.color)&&(s.up(this.color).isEmpty()||s.up(this.color).chessMan.color!==this.color)&&t.push(s.up(this.color).location)}if(this.field.right(this.color)&&this.field.right(this.color).right(this.color)){const s=this.field.right(this.color).right(this.color);s.down(this.color)&&(s.down(this.color).isEmpty()||s.down(this.color).chessMan.color!==this.color)&&t.push(s.down(this.color).location),s.up(this.color)&&(s.up(this.color).isEmpty()||s.up(this.color).chessMan.color!==this.color)&&t.push(s.up(this.color).location)}return t}}class f extends a{getValue(){return 3}getUnicode(){return this.isWhite()?"♝":this.isBlack()?"♗":super.getUnicode()}getAlias(){return this.isWhite()?"B":this.isBlack()?"b":super.getAlias()}getMoves(){return[...this.getMovesUpLeftAll(),...this.getMovesUpRightAll(),...this.getMovesDownRightAll(),...this.getMovesDownLeftAll()]}}class y extends a{getValue(){return 5}getUnicode(){return this.isWhite()?"♜":this.isBlack()?"♖":super.getUnicode()}getAlias(){return this.isWhite()?"R":this.isBlack()?"r":super.getAlias()}getMoves(){return[...this.getMovesUpAll(),...this.getMovesDownAll(),...this.getMovesLeftAll(),...this.getMovesRightAll()]}isRook(){return!0}}class m{constructor(t,s){this.color=t,this.board=s,this.chessMen=[],this.king=null,this.moves={}}getMoves(){const t={};return this.chessMen.map(s=>{s.isInGame()&&Object.assign(t,{[s.field.location]:s.getMoves()})}),this.isLeftCastlingPossible()&&t[this.king.field.location].push(this.king.field.left().left().location),this.isRightCastlingPossible()&&t[this.king.field.location].push(this.king.field.right().right().location),t}getAttackingFields(){let t=[];return this.chessMen.map(s=>{s.isInGame()&&(t=[...t,...s.getMoves()])}),t}getLowestValuePieceAttackingLocation(t){let s=null;return this.chessMen.map(i=>{i.isInGame()&&i.getMoves().map(e=>{e===t&&(null===s||i.getValue()<s)&&(s=i.getValue())})}),s}getHighestValueAttackingPiece(){let t=0;return this.chessMen.map(s=>{s.isInGame()&&s.getMoves().map(s=>{this.board.getChessman(s)&&this.board.getChessman(s).color!==this.color&&this.board.getChessman(s).getValue()>t&&(t=this.board.getChessman(s).getValue())})}),t}addChessman(t,s){this.board.addChessman(t,s),this.chessMen.push(t)}addKing(t){const s=new u(this.color);this.addChessman(s,t),this.king=s}addQueen(t){this.addChessman(new d(this.color),t)}addRook(t){this.addChessman(new y(this.color),t)}addBishop(t){this.addChessman(new f(this.color),t)}addKnight(t){this.addChessman(new p(this.color),t)}addPawn(t){this.addChessman(new g(this.color),t)}addPawns(t=[]){t.map(t=>{this.addPawn(t)})}isLeftCastlingPossible(){if(this.color===l&&!this.board.castlings.whiteLong)return!1;if(this.color===r&&!this.board.castlings.blackLong)return!1;let t=this.king.field;return t=t.left(),!(!t||!t.isEmpty()||this.board.getPlayerEnemyByColor(this.color).getAttackingFields().includes(t.location))&&(t=t.left(),!(!t||!t.isEmpty()||this.board.getPlayerEnemyByColor(this.color).getAttackingFields().includes(t.location))&&(t=t.left(),!(!t||!t.isEmpty())&&(t=t.left(),!!(t&&t.chessMan&&t.chessMan.color===this.color&&t.chessMan.isRook()))))}isRightCastlingPossible(){if(this.color===l&&!this.board.castlings.whiteShort)return!1;if(this.color===r&&!this.board.castlings.blackShort)return!1;let t=this.king.field;return t=t.right(),!(!t||!t.isEmpty()||this.board.getPlayerEnemyByColor(this.color).getAttackingFields().includes(t.location))&&(t=t.right(),!(!t||!t.isEmpty()||this.board.getPlayerEnemyByColor(this.color).getAttackingFields().includes(t.location))&&(t=t.right(),!!(t&&t.chessMan&&t.chessMan.color===this.color&&t.chessMan.isRook())))}}const w=-1e3,M=1e3;class b{constructor(){this.playerWhite=new m(l,this),this.playerBlack=new m(r,this),this.playingPlayer=this.playerWhite,this.isFinished=!1,this.checkMate=!1,this.castlings={whiteLong:!0,whiteShort:!0,blackLong:!0,blackShort:!0},this.counters={halfMove:0,fullMove:1},this.enPassant=null,this.init()}calculateAiMove(t){return this.calculateAiMoves(t)[0]}calculateAiMoves(t){if(t=parseInt(t),!h.includes(t))throw new Error(`Invalid level ${t}. You can choose ${h}`);const s=this.playingPlayer.color,i=[];for(const e in this.playingPlayer.moves)this.playingPlayer.moves[e].map(o=>{i.push({from:e,to:o,score:this.testMoveScores(e,o,s,t)+Math.floor(Math.random()*Math.floor(2))})});return i.sort((t,s)=>t.score<s.score?0:-1),i}testMoveScores(t,s,i,e,o=0){const r=this.exportJson(),l=(new b).createFromJson(r);if(l.move(t,s,!1),(o<e||this.hasPlayingPlayerCheck())&&l.recalculate(),o>=e||l.checkMate)return l.calculateScore(i)+(this.playingPlayer.color===i?-o:o);const h=l.playingPlayer.moves;let n=l.playingPlayer.color===i?w:M;for(const t in h)h[t].map(s=>{const r=l.testMoveScores(t,s,i,e,o+1);n=l.playingPlayer.color===i?Math.max(n,r):Math.min(n,r)});return n}calculateScore(t=this.playingPlayer.color){let s=0;return this.checkMate?this.playingPlayer.color===t?w:M:(this.getPlayerByColor(t).chessMen.map(i=>{i.isInGame()&&(s+=10*i.getValue(),i.isPawn()&&(t===l&&i.field.location[1]>2&&(s+=1),t===r&&i.field.location[1]<7&&(s+=1)),i.getMoves().map(i=>{this.getChessman(i)&&this.getChessman(i).color!==t&&(s+=this.getChessman(i).getValue()-1)}))}),this.getPlayerEnemyByColor(t).chessMen.map(i=>{i.isInGame()&&(s-=10*i.getValue(),i.getMoves().map(i=>{this.getChessman(i)&&this.getChessman(i).color===t&&(s-=this.getChessman(i).getValue()-1)}))}),s)}recalculate(){this.playingPlayer.moves=this.calculateMoves(this.playingPlayer);const t=Object.keys(this.playingPlayer.moves).length;return this.isFinished=0===t,this.checkMate=0===t&&this.hasPlayingPlayerCheck(),this}calculateMoves(t){const s={},i=t.getMoves(),e=this.exportJson();for(const o in i)i[o].map(i=>{const h=(new b).createFromJson(e);h.move(o,i,!1),(t.color===l&&h.playerWhite.king.field&&!h.hasWhitePlayerCheck()||t.color===r&&h.playerBlack.king.field&&!h.hasBlackPlayerCheck())&&(s[o]||(s[o]=[]),s[o].push(i))});return s}getNonPlayingPlayer(){return this.playingPlayer.color===l?this.playerBlack:this.playerWhite}getPlayerByColor(t=l){return t===l?this.playerWhite:this.playerBlack}getPlayerEnemyByColor(t=l){return t===l?this.playerBlack:this.playerWhite}hasPlayingPlayerCheck(){return this.getNonPlayingPlayer().getAttackingFields().includes(this.playingPlayer.king.field.location)}hasNonPlayingPlayerCheck(){return this.playingPlayer.getAttackingFields().includes(this.getNonPlayingPlayer().king.field.location)}hasWhitePlayerCheck(){return this.playerBlack.getAttackingFields().includes(this.playerWhite.king.field.location)}hasBlackPlayerCheck(){return this.playerWhite.getAttackingFields().includes(this.playerBlack.king.field.location)}init(){this.board={};let t=l;e.map(s=>{t=t===r?l:r,o.map(i=>{this.board[s]||(this.board[s]={}),this.board[s][i]=new c(t,`${s}${i}`),t=t===r?l:r})}),e.map(t=>{o.map(s=>{"A"!==t&&(this.board[t][s].neighbours.left=this.board[String.fromCharCode(t.charCodeAt(0)-1)][s]),"H"!==t&&(this.board[t][s].neighbours.right=this.board[String.fromCharCode(t.charCodeAt(0)+1)][s]),"1"!==s&&(this.board[t][s].neighbours.down=this.board[t][String.fromCharCode(s.charCodeAt(0)-1)]),"8"!==s&&(this.board[t][s].neighbours.up=this.board[t][String.fromCharCode(s.charCodeAt(0)+1)])})})}createFromJson(t={}){for(let s in t.pieces){const i=t.pieces[s];switch(s=s.toUpperCase(),i){case"K":this.playerWhite.addKing(s);break;case"Q":this.playerWhite.addQueen(s);break;case"R":this.playerWhite.addRook(s);break;case"B":this.playerWhite.addBishop(s);break;case"N":this.playerWhite.addKnight(s);break;case"P":this.playerWhite.addPawn(s);break;case"k":this.playerBlack.addKing(s);break;case"q":this.playerBlack.addQueen(s);break;case"r":this.playerBlack.addRook(s);break;case"b":this.playerBlack.addBishop(s);break;case"n":this.playerBlack.addKnight(s);break;case"p":this.playerBlack.addPawn(s)}}return t.turn===this.playerBlack.color?this.playingPlayer=this.playerBlack:t.turn===this.playerWhite.color&&(this.playingPlayer=this.playerWhite),t.castling&&"object"==typeof t.castling&&Object.assign(this.castlings,t.castling),t.counters&&"object"==typeof t.counters&&Object.assign(this.counters,t.counters),t.enPassant&&this.isLocationValid(t.enPassant)&&(this.enPassant=t.enPassant),this}exportJson(){const t={pieces:{}};return this.playerWhite.chessMen.map(s=>{s.isInGame()&&Object.assign(t.pieces,{[s.field.location]:s.getAlias()})}),this.playerBlack.chessMen.map(s=>{s.isInGame()&&Object.assign(t.pieces,{[s.field.location]:s.getAlias()})}),Object.assign(t,{turn:this.playingPlayer.color},{moves:this.playingPlayer.moves},{isFinished:this.isFinished},{checkMate:this.checkMate},{castling:this.castlings},{counters:this.counters},{enPassant:this.enPassant}),t}exportFEN(){let t="";Object.assign([],o).reverse().map(s=>{let i=0;s<8&&(t+="/"),e.map(e=>{const o=this.getChessman(`${e}${s}`);o?(i&&(t+=i.toString(),i=0),t+=o.getAlias()):i++}),t+=""+(i||"")}),t+=this.playingPlayer.color===l?" w ":" b ";const{whiteShort:s,whiteLong:i,blackLong:r,blackShort:h}=this.castlings;return i||s||r||h?(s&&(t+="K"),i&&(t+="Q"),h&&(t+="k"),r&&(t+="q")):t+="-",t+=" "+(this.enPassant?this.enPassant.toLowerCase():"-"),t+=" "+this.counters.halfMove,t+=" "+this.counters.fullMove,t}move(t,s,i=!0){const e=this.board[t[0]][t[1]],o=this.board[s[0]][s[1]];if(!e.chessMan)throw new Error("There is no piece at "+t);const h=e.chessMan,n=o.chessMan;if(n&&(n.field=null),h.field=o,e.chessMan=null,o.chessMan=h,h.moved=!0,this.playingPlayer.color===l&&h.isPawn()&&"8"===s[1]&&this.playerWhite.addQueen(s),this.playingPlayer.color===r&&h.isPawn()&&"1"===s[1]&&this.playerBlack.addQueen(s),h.isPawn()&&s===this.enPassant){const t=o.down(this.playingPlayer.color);t.chessMan.field=null,t.chessMan=null}if(h.isPawn()&&this.playingPlayer.color===l&&"2"===t[1]&&"4"===s[1]?this.enPassant=t[0]+"3":h.isPawn()&&this.playingPlayer.color===r&&"7"===t[1]&&"5"===s[1]?this.enPassant=t[0]+"6":this.enPassant=null,"E1"===t&&Object.assign(this.castlings,{whiteLong:!1,whiteShort:!1}),"E8"===t&&Object.assign(this.castlings,{blackLong:!1,blackShort:!1}),"A1"===t&&Object.assign(this.castlings,{whiteLong:!1}),"H1"===t&&Object.assign(this.castlings,{whiteShort:!1}),"A8"===t&&Object.assign(this.castlings,{blackLong:!1}),"H8"===t&&Object.assign(this.castlings,{blackShort:!1}),h.isKing()){if("E1"===t&&"C1"===s)return this.move("A1","D1");if("E8"===t&&"C8"===s)return this.move("A8","D8");if("E1"===t&&"G1"===s)return this.move("H1","F1");if("E8"===t&&"G8"===s)return this.move("H8","F8")}this.playingPlayer=this.getNonPlayingPlayer(),i&&(this.playingPlayer.color===l&&this.counters.fullMove++,this.counters.halfMove++,(n||h.isPawn())&&(this.counters.halfMove=0),this.recalculate())}addChessman(t,s){if(!this.isLocationValid(s))throw new Error("Invalid location "+s);t.board=this,this.board[s[0]][s[1]].setField(t)}getChessman(t){if(!this.isLocationValid(t))throw new Error("Invalid location "+t);return this.board[t[0]][t[1]].chessMan||null}isLocationValid(t){return t.match("^[a-hA-H]{1}[1-8]{1}$")}print(){process.stdout.write("\n"),Object.assign([],o).reverse().map(t=>{process.stdout.write(""+t),e.map(s=>{process.stdout.write(this.board[s][t].getUnicode())}),process.stdout.write("\n")}),process.stdout.write(" "),e.map(t=>{process.stdout.write(""+t)}),process.stdout.write("\n")}}class P{constructor(t=n){this.board=(new b).createFromJson(t).recalculate()}move(t,s){if(t=t.toUpperCase(),s=s.toUpperCase(),!this.board.playingPlayer.moves[t]||!this.board.playingPlayer.moves[t].includes(s))throw new Error(`Invalid move from ${t} to ${s} for ${this.board.playingPlayer.color}`);this.board.move(t,s)}moves(t=null){return(t?this.board.playingPlayer.moves[t.toUpperCase()]:this.board.playingPlayer.moves)||[]}aiMove(t=2){const s=this.board.calculateAiMove(t);return this.move(s.from,s.to)}printToConsole(){this.board.print()}exportJson(){return this.board.exportJson()}exportFEN(){return this.board.exportFEN()}}function v(t){return new P(t).moves()}function k(t){return new P(t).exportJson()}function A(t){return new P(t).exportFEN()}function C(t){const s=new P(t);return s.move(t.move.from,t.move.to),s.exportJson()}function E(t,s=2){const i=new P(t).board.calculateAiMove(s);return{[i.from]:i.to}}}])}));